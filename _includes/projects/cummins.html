{% include base_path %}

<div id="cummins" class="project-content">
  <div class="project-header">
    <!-- <h2>Cummins Research Project</h2> -->
    <!-- <div class="project-meta">Industry Research Project</div> -->
  </div>
  
  <div class="project-description">
    <h3>Overview</h3>
    <p>
      This project focused on developing a neural-network-based predictive model for 
      estimating the phase currents drawn by a Permanent Magnet Synchronous Motor (PMSM). 
      The objective was to design a fast and accurate surrogate model capable of 
      predicting three-phase motor currents using inputs such as control signals, speed, load 
      torque, motor angle, and field current. The model needed to meet strict industrial 
      constraints, including <strong>prediction error under 2%</strong> and 
      <strong>inference time below 0.5 μs</strong>
    </p>

    <h3>Project Objectives</h3>
    <ul>
      <li>Analyze PMSM physical behavior and current dynamics</li>
      <li>Develop a high-accuracy neural network for phase-current prediction</li>
      <li>Test multiple model architectures and activation functions</li>
      <li>Achieve sub-microsecond inference time suitable for real-time motor control</li>
      <li>Identify and resolve modeling challenges such as spiking and mixed input types</li>
    </ul>

    <h3>Methodology</h3>
    <p>The approach involved iterative model design, training, and validation:</p>
    <ul>
      <li>
        <strong>Data Collection:</strong> Input features included motor speed, field current, load torque, motor angle, 
        and binary control signals for all three phases
      </li>
      <li><strong>Architecture Prototyping:</strong> Multiple versions of neural networks were tested (ReLU-only, Tanh, mixed-activation).</li>
      <li><strong>Training & Optimization:</strong> All continuous features were normalized to the range [-1, 1].</li>
      <li><strong>Evaluation:</strong> Predictions were validated against simulated PMSM current waveforms, including analysis of switching-induced spikes.</li>
    </ul>

    <!-- <h3>Failed Architecture 1</h3>
    <table class="project-table">
      <thead>
        <tr><th>Input Features</th><th>Output Features</th><th>Activation Function</th></tr>
      </thead>
      <tbody>
        <tr><td>7</td><td>64</td><td>ReLU</td></tr>
        <tr><td>64</td><td>128</td><td>ReLU</td></tr>
        <tr><td>128</td><td>3</td><td>—</td></tr>
      </tbody>
    </table>
    <p class="small-note">The model failed to capture required nonlinear dependencies :contentReference[oaicite:3]{index=3}.</p>

    <h3>Failed Architecture 2</h3>
    <table class="project-table">
      <thead>
        <tr><th>Input Features</th><th>Output Features</th><th>Activation Function</th></tr>
      </thead>
      <tbody>
        <tr><td>7</td><td>64</td><td>Tanh</td></tr>
        <tr><td>64</td><td>128</td><td>ReLU</td></tr>
        <tr><td>128</td><td>3</td><td>—</td></tr>
      </tbody>
    </table>
    <p class="small-note">Tanh improved nonlinear fitting, but mixing binary + continuous in the same path hurt performance.</p> -->

    <h3>Final Architecture</h3>
    <p>The final model separates binary and continuous inputs into parallel branches before merging.</p>

    <!-- EXACT TABLE FORMAT (TABLE 3 FROM THE PAPER) -->
    <table class="project-table">
      <thead>
        <tr>
          <th>Branch</th>
          <th>Input Features</th>
          <th>Output Features</th>
          <th>Activation Function</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Binary</td><td>3</td><td>128</td><td>ReLU</td></tr>
        <tr><td>Binary</td><td>128</td><td>256</td><td>ReLU</td></tr>
        <tr><td>Continuous</td><td>4</td><td>128</td><td>Tanh</td></tr>
        <tr><td>Continuous</td><td>128</td><td>256</td><td>ReLU</td></tr>
        <tr><td>Combined</td><td>256</td><td>1024</td><td>ReLU</td></tr>
        <tr><td>Combined</td><td>1024</td><td>512</td><td>ReLU</td></tr>
        <tr><td>Output</td><td>512</td><td>3</td><td>—</td></tr>
      </tbody>
    </table>
    <p class="small-note">Final Model Architecture

    <h3>Inference Time</h3>
    <p>
      The industrial requirement was an inference time <strong>&lt; 0.5 μs</strong>.  
      While Colab GPU benchmarks could not satisfy this, FPGA estimates based on the
      final architecture showed a theoretical <strong>0.4 μs</strong> inference time at 250 MHz, 
      satisfying real-time control constraints.
    </p>

    <h3>Hardware / Verilog Implementation</h3>
    <p>
      To validate hardware feasibility, a smaller NN (7→128→128→3) was quantized and implemented in Verilog
    </p>

    <ul>
      <li>Each layer implemented as a separate Verilog module</li>
      <li>Tanh activation approximated using a LUT for high-speed evaluation</li>
      <li>Weights & biases quantized to <strong>4-bit signed integers</strong> for FPGA arithmetic</li>
      <li>Python script auto-generated Verilog ROM blocks for weights/biases</li>
      <li>Layer completion handshaking via `done` signals (module-to-module sync)</li>
    </ul>

    <h3>Results & Impact</h3>
    <ul>
      <li>Final NN achieved <strong>&lt; under 2% current-prediction error</strong></li>
      <li>Architecture suitable for FPGA-based sub-microsecond inference</li>
      <li>Accurate phase current predictions demonstrated using test waveforms</li>
      <li>Method provides a lightweight surrogate model for PMSM current simulation</li>
    </ul>

    <h3>Phase Current Prediction Results</h3>
    <p>The following plots demonstrate the model's performance in predicting phase currents:</p>
    
    <div class="diagram-container">
      <img src="{{ base_path }}/images/cummins/phaseA.png" alt="Current Phase A">
      <p class="diagram-caption">Current Phase A</p>
    </div>
    
    <div class="diagram-container">
      <img src="{{ base_path }}/images/cummins/phaseB.png" alt="Current Phase B">
      <p class="diagram-caption">Current Phase B</p>
    </div>
    
    <div class="diagram-container">
      <img src="{{ base_path }}/images/cummins/phaseC.png" alt="Current Phase C">
      <p class="diagram-caption">Current Phase C</p>
    </div>

    <h3>Technologies & Tools</h3>
    <p><strong>Concepts:</strong> Neural Networks, Nonlinear System Modeling, Real-time Inference</p>
    <p><strong>Software:</strong> Python, NumPy/PyTorch, Verilog HDL</p>
  </div>
  
  <div class="project-links">
    <a href="/files/Cummins_report.pdf" target="_blank">View Full Report (PDF)</a>
  </div>
</div>
